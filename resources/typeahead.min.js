/*!
	Typeahead search v0.1.3
*/
(function(a){function c(){this.version="0.1.3";this.init=function(f,e){return new b(f,e)};return this}function b(g,f){if(!f){f={}}if(typeof g==="string"){g=document.querySelector(g)}if(!g){console.warn("No valid element provided");return this}var l=this;var o={};var j,e;var m=(typeof f.inline==="boolean"?f.inline:false);function p(C,w,B){var q,r,u,x,v,z,y;x=C.toUpperCase();u=[];if(x){for(r=0;r<f.items.length;r++){z={rank:0,key:r,value:f.items[r]};if(typeof f.rank==="function"){z.rank=f.rank(f.items[r],C)}else{if(f.items[r].toUpperCase().indexOf(x)==0){z.rank+=3}if(f.items[r].toUpperCase().indexOf(x)>0){z.rank+=1}}u.push(z)}u=d(u,"rank")}if(!j){g.parentElement.style.position="relative";j=document.createElement("div");j.classList.add("typeahead-results");j.style.top=(g.offsetTop+g.offsetHeight)+"px";j.style.left=g.offsetLeft+"px";j.style.maxWidth=(g.parentElement.offsetWidth-g.offsetLeft-parseInt(window.getComputedStyle(g.parentElement,null).getPropertyValue("padding-right")))+"px";j.style.position="absolute";e.style.position="relative";g.insertAdjacentElement("afterend",j)}v="";if(u.length>0){q=Math.min(u.length,(typeof f.max==="number"?f.max:10));v="<ol>";for(r=0;r<q;r++){if(u[r].rank>0){v+='<li data-id="'+u[r].key+'" '+(r==0?' class="selected"':"")+'><a tabindex="0" href="#" class="name">'+(typeof f.render==="function"?f.render(f.items[u[r].key]):f.items[u[r].key])+"</a></li>"}}v+="</ol>"}j.innerHTML=v;if(m){g.style.marginBottom=j.offsetHeight+"px"}var A=n();for(r=0;r<A.length;r++){A[r].addEventListener("click",function(s){s.preventDefault();s.stopPropagation();i(this.getAttribute("data-id"))})}if(o[B]){w._typeahead=l;for(r=0;r<o[B].length;r++){y=o[B][r];w.data=y.data||{};if(typeof y.fn==="function"){y.fn.call(this,w)}}}return this}function n(){return(j?j.querySelectorAll("li"):[])}function i(q){if(q){l.input=g;if(typeof f.process==="function"){f.process.call(l,f.items[q])}else{console.log(f.items[q])}}if(j){j.innerHTML=""}if(m){g.style.marginBottom="0px"}return}function k(){var q=n();for(var r=0;r<q.length;r++){if(q[r].classList.contains("selected")){return i(q[r].getAttribute("data-id"))}}return}function h(v){var q=n();var t=-1;var u;for(var r=0;r<q.length;r++){if(q[r].classList.contains("selected")){t=r}}u=t;if(v==40){t++}else{t--}if(t<0){t=q.length-1}if(t>=q.length){t=0}if(u>=0){q[u].classList.remove("selected")}q[t].classList.add("selected")}this.on=function(r,s,q){if(!g){console.warn("Unable to attach event "+r);return this}if(r=="change"){if(!o[r]){o[r]=[];g.addEventListener("keyup",function(t){t.preventDefault();t.stopPropagation();if(t.keyCode==40||t.keyCode==38){h(t.keyCode)}else{if(t.keyCode==13){k()}else{p(this.value,t,r);if(typeof f.endsearch==="function"){f.endsearch(this.value)}}}});g.addEventListener("blur",function(t){if(typeof f.blur==="function"){f.blur()}})}o[r].push({fn:q,data:s})}else{if(r=="blur"){console.log("blur")}else{console.warn("No event of type "+r)}}return this};this.off=function(s,r){if(o[s]){for(var q=0;q<o[s].length;q++){if(o[s][q].fn==r){o[s].splice(q,1)}}}};if(g.form){e=g.form;e.addEventListener("submit",function(q){q.preventDefault();q.stopPropagation();k()},false)}if(g){g.setAttribute("autocomplete","off")}this.addItems=function(q){if(!f.items){f.items=[]}f.items=f.items.concat(q)};this.on("change",{test:"blah"},function(q){console.log("change end")});return this}a.TypeAhead=new c();function d(e,f){return e.sort(function(h,g){return h[f]<g[f]?1:-1})}})(window||this);